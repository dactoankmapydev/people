<!DOCTYPE html>
<html lang="vi">

<head>
   <title> Dùng .NET Framework với IronPython  - The PyMiers</title>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="robots" content="" />
  <link rel="stylesheet" type="text/css" href="/theme/css/app.css">
<link rel="stylesheet" type="text/css" href="http://pp.pymi.vn/theme/css/pygment.css">
  <link href="https://fonts.googleapis.com/css?family=Fira+Sans" rel="stylesheet">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">    <meta name="author" content="Pymiers" />
  <meta name="description" content="" />    <link href="http://pp.pymi.vn/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="The PyMiers Full Atom Feed" />       <link href="http://pp.pymi.vn/feeds/trang-chu.atom.xml" type="application/atom+xml" rel="alternate" title="The PyMiers Categories Atom Feed" />     
  <meta name="tags" content="ironpython" />
  <meta name="tags" content="windows" />
  <meta name="tags" content="dotnet" />
  <meta name="tags" content="reference" />
  <meta name="tags" content="dll" />
</head>

<body>
  <main class="wrapper">
    <section class="container">
      <header class='column'>
        <h1 class='title'><a href="http://pp.pymi.vn/">The PyMiers</a></h1>
      </header>

      <div class="section">
        <div class="row navbar">
          <div class="column nav-item is-active"><a href="http://pp.pymi.vn/category/trang-chu/">Trang chủ</a></div>
           <div class="column nav-item "><a href="http://pp.pymi.vn/pages/about/">About</a></div>
          <div class="column nav-item "><a href="http://pp.pymi.vn/pages/add/">Tạo bài viết</a></div>
          <div class="column nav-item"><a href="/archives">Archives</a></div>
        </div>
      </div>
    </section>

<section class="container">
  <header>
    <h2 class="entry-title">
      <a href="http://pp.pymi.vn/article/ironpython-addreference/" rel="bookmark"
         title="Permalink to Dùng .NET Framework với IronPython">Dùng .NET Framework với IronPython</a></h2>  
  </header>
  <footer class='center'>
    <time class="published" datetime="2018-06-02T00:00:00+07:00"> 02/06/2018 </time>
    <address class="vcard author">By
                    <a class="url fn" href="http://pp.pymi.vn/author/htlcnn/">htlcnn</a>
 in <a href="http://pp.pymi.vn/category/trang-chu/">Trang chủ</a>
                </address>     <em>Tags</em>:     <a href="http://pp.pymi.vn/tag/ironpython/"><em>ironpython</em></a>,     <a href="http://pp.pymi.vn/tag/windows/"><em>windows</em></a>,     <a href="http://pp.pymi.vn/tag/dotnet/"><em>dotnet</em></a>,     <a href="http://pp.pymi.vn/tag/reference/"><em>reference</em></a>,     <a href="http://pp.pymi.vn/tag/dll/"><em>dll</em></a>    </footer>
  <br>
  <div class="entry-content">
    <h2>Assembly là gì</h2>
<p><a href="https://msdn.microsoft.com/en-us/library/ms973231.aspx#assenamesp_topic4">Assembly</a> (số nhiều: assemblies) là một file được tạo ra bởi quá trình compile một ứng dụng .NET. Nó có thể có đuôi <code>.dll</code> hoặc <code>.exe</code>. .NET Framework có sẵn rất nhiều assemblies (chính là thành phần <a href="https://msdn.microsoft.com/en-us/library/gg145045.aspx">Class Library trong .NET Framework</a>), cũng tương tự như Python có sẵn rất nhiều <a href="https://docs.python.org/3/library/index.html">standard libraries</a> vậy.</p>
<h2>AddReference .NET Assemblies</h2>
<p>Khi lập trình các ngôn ngữ .NET khác như C# hay VB.NET, dùng Visual Studio, muốn sử dụng các công cụ trong .NET Framework thì bạn phải thêm "Reference" vào project browser. IronPython có 1 module hỗ trợ "Add Reference" vào script là <code>clr</code>. Các methods Add Reference trong IronPython:</p>
<div class="codehilite" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #75715e"># Sử dụng một trong các methods sau</span>
<span style="color: #f8f8f2">clr</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">AddReference</span>
<span style="color: #f8f8f2">clr</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">AddReferenceByName</span>
<span style="color: #f8f8f2">clr</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">AddReferenceByPartialName</span>
<span style="color: #f8f8f2">clr</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">AddReferenceToFile</span>
<span style="color: #f8f8f2">clr</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">AddReferenceToFileAndPath</span>
</pre></div>


<p><code>clr.AddReference</code> nhận vào 1 đối tượng <a href="https://msdn.microsoft.com/en-us/library/system.reflection.assembly(v=vs.110).aspx">System.Reflection.Assembly</a>, hoặc <strong>full name</strong> của assembly (vd <code>clr.AddReference("System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</code>), hoặc <strong>partial name</strong> của assembly (vd <code>clr.AddReference("System.Drawing")</code>). Khi dùng partial name, IronPython sẽ tìm file dll ở trong <a href="https://docs.microsoft.com/en-us/dotnet/framework/app-domains/gac">Global Assembly Cache (GAC)</a>. Mình thường dùng cách thứ 3: truyền vào partial name cho ngắn gọn.
Xem các assemblies đã add ở <code>clr.References</code>:</p>
<div class="codehilite" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #f8f8f2">C:</span>\<span style="color: #f8f8f2">Users</span>\<span style="color: #f8f8f2">HTL</span><span style="color: #f92672">&gt;</span><span style="color: #e6db74">&quot;c:\Program Files (x86)\IronPython 2.7\ipy.exe&quot;</span>
<span style="color: #f8f8f2">IronPython</span> <span style="color: #ae81ff">2.7</span><span style="color: #f92672">.</span><span style="color: #ae81ff">3</span> <span style="color: #f8f8f2">(</span><span style="color: #ae81ff">2.7</span><span style="color: #f92672">.</span><span style="color: #ae81ff">0.40</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">on</span> <span style="color: #f92672">.</span><span style="color: #f8f8f2">NET</span> <span style="color: #ae81ff">4.0</span><span style="color: #f92672">.</span><span style="color: #ae81ff">30319.42000</span> <span style="color: #f8f8f2">(</span><span style="color: #ae81ff">32</span><span style="color: #f92672">-</span><span style="color: #f8f8f2">bit)</span>
<span style="color: #f8f8f2">Type</span> <span style="color: #e6db74">&quot;help&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;copyright&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;credits&quot;</span> <span style="color: #f92672">or</span> <span style="color: #e6db74">&quot;license&quot;</span> <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">more</span> <span style="color: #f8f8f2">information</span><span style="color: #f92672">.</span>
<span style="color: #f92672">&gt;&gt;&gt;</span> <span style="color: #f92672">import</span> <span style="color: #f8f8f2">clr</span>
<span style="color: #f92672">&gt;&gt;&gt;</span> <span style="color: #f8f8f2">clr</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">AddReference(</span><span style="color: #e6db74">&quot;System.Drawing&quot;</span><span style="color: #f8f8f2">)</span>
<span style="color: #f92672">&gt;&gt;&gt;</span> <span style="color: #f8f8f2">clr</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">References</span>
<span style="color: #f8f8f2">(</span><span style="color: #f92672">&lt;</span><span style="color: #f8f8f2">mscorlib,</span> <span style="color: #f8f8f2">Version</span><span style="color: #f92672">=</span><span style="color: #ae81ff">4.0</span><span style="color: #f92672">.</span><span style="color: #ae81ff">0.0</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">Culture</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">neutral,</span> <span style="color: #f8f8f2">PublicKeyToken</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">b77a5c561934e089</span><span style="color: #f92672">&gt;</span><span style="color: #f8f8f2">,</span>
<span style="color: #f92672">&lt;</span><span style="color: #f8f8f2">System,</span> <span style="color: #f8f8f2">Version</span><span style="color: #f92672">=</span><span style="color: #ae81ff">4.0</span><span style="color: #f92672">.</span><span style="color: #ae81ff">0.0</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">Culture</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">neutral,</span> <span style="color: #f8f8f2">PublicKeyToken</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">b77a5c561934e089</span><span style="color: #f92672">&gt;</span><span style="color: #f8f8f2">,</span>
<span style="color: #f92672">&lt;</span><span style="color: #f8f8f2">IronPython</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">SQLite,</span> <span style="color: #f8f8f2">Version</span><span style="color: #f92672">=</span><span style="color: #ae81ff">2.7</span><span style="color: #f92672">.</span><span style="color: #ae81ff">0.40</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">Culture</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">neutral,</span> <span style="color: #f8f8f2">PublicKeyToken</span><span style="color: #f92672">=</span><span style="color: #ae81ff">7</span><span style="color: #f8f8f2">f709c5b71</span>
<span style="color: #ae81ff">3576e1</span><span style="color: #f92672">&gt;</span><span style="color: #f8f8f2">,</span>
<span style="color: #f92672">&lt;</span><span style="color: #f8f8f2">IronPython</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Wpf,</span> <span style="color: #f8f8f2">Version</span><span style="color: #f92672">=</span><span style="color: #ae81ff">2.7</span><span style="color: #f92672">.</span><span style="color: #ae81ff">0.40</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">Culture</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">neutral,</span> <span style="color: #f8f8f2">PublicKeyToken</span><span style="color: #f92672">=</span><span style="color: #ae81ff">7</span><span style="color: #f8f8f2">f709c5b713576e1</span><span style="color: #f92672">&gt;</span><span style="color: #f8f8f2">,</span>
<span style="color: #f92672">&lt;</span><span style="color: #f8f8f2">System</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Drawing,</span> <span style="color: #f8f8f2">Version</span><span style="color: #f92672">=</span><span style="color: #ae81ff">4.0</span><span style="color: #f92672">.</span><span style="color: #ae81ff">0.0</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">Culture</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">neutral,</span> <span style="color: #f8f8f2">PublicKeyToken</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">b03f5f7f11d50a3a</span><span style="color: #f92672">&gt;</span><span style="color: #f8f8f2">)</span>

<span style="color: #f92672">&gt;&gt;&gt;</span>
</pre></div>


<p>Sau khi <code>AddReference</code>, phải <code>import</code> các namespaces có trong assemblies để sử dụng trong IronPython. Cú pháp import như bình thường:</p>
<div class="codehilite" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #f92672">&gt;&gt;&gt;</span> <span style="color: #f92672">from</span> <span style="color: #f8f8f2">System</span> <span style="color: #f92672">import</span> <span style="color: #f8f8f2">Drawing</span>
<span style="color: #f92672">&gt;&gt;&gt;</span> <span style="color: #66d9ef">print</span><span style="color: #f8f8f2">(Drawing)</span>
<span style="color: #f8f8f2">Microsoft</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Scripting</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Actions</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">NamespaceTracker:System</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Drawing</span>
<span style="color: #f92672">&gt;&gt;&gt;</span>
</pre></div>


<p>Thắc mắc hay gặp: Mình muốn sử dụng 1 công cụ trong .NET Framework thì biết tên assembly là gì để <code>AddReference</code>, biết namespace nào để <code>import</code>? Trả lời với từ khóa tìm kiếm: <code>Tên_công_cụ msdn</code> (VD <a href="http://lmgtfy.com/?s=d&amp;q=System+Environment+msdn">System Environment msdn</a>). Dùng phần <strong>Assembly</strong> để <code>AddReference</code>, phần <strong>Namespace</strong> để <code>import</code>.</p>
<p>Khi chạy ipy.exe, IronPython đã AddReference sẵn tới mscorlib.dll và System.dll <a href="http://ironpython.net/documentation/dotnet/dotnet.html#assemblies-loaded-by-default"><sup>[1]</sup></a>. Khi đó chỉ việc <code>import</code> các namespaces có trong 2 assemblies này mà không phải AddRerence.</p>
<h2>AddReference các Assemblies khác</h2>
<p>Ngoài các assemblies có trong .NET Framework, còn có các assemblies khác đi kèm với các phần mềm cài vào Windows, hoặc assemblies được compiled từ chính IronPython. Cú pháp AddReference tương tự như trên, với lưu ý là <code>AddReference</code> khi đó sẽ tìm assemblies trong GAC hoặc <code>sys.path</code>. Nếu không muốn append đường dẫn tới folder chứa file .dll thì có thể dùng <code>AddReferenceToFileAndPath</code>. Phải chạy đúng phiên bản IronPython 32bit/64bit tương ứng với <a href="https://msdn.microsoft.com/en-us/library/hh264221.aspx#Target%20Platform">Target Platform</a> mà file assembly được compiled.</p>
<p>Ví dụ file <code>RevitAPI.dll</code> được compiled với Target Platform là x64 (64-bit), nếu chạy <code>ipy.exe</code> (32-bit) sẽ không <code>AddReference</code> được:</p>
<div class="codehilite" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #f8f8f2">C:</span>\<span style="color: #f8f8f2">Users</span>\<span style="color: #f8f8f2">HTL</span><span style="color: #f92672">&gt;</span><span style="color: #e6db74">&quot;C:\Program Files (x86)\IronPython 2.7\ipy.exe&quot;</span>
<span style="color: #f8f8f2">IronPython</span> <span style="color: #ae81ff">2.7</span><span style="color: #f92672">.</span><span style="color: #ae81ff">3</span> <span style="color: #f8f8f2">(</span><span style="color: #ae81ff">2.7</span><span style="color: #f92672">.</span><span style="color: #ae81ff">0.40</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">on</span> <span style="color: #f92672">.</span><span style="color: #f8f8f2">NET</span> <span style="color: #ae81ff">4.0</span><span style="color: #f92672">.</span><span style="color: #ae81ff">30319.42000</span> <span style="color: #f8f8f2">(</span><span style="color: #ae81ff">32</span><span style="color: #f92672">-</span><span style="color: #f8f8f2">bit)</span>
<span style="color: #f8f8f2">Type</span> <span style="color: #e6db74">&quot;help&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;copyright&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;credits&quot;</span> <span style="color: #f92672">or</span> <span style="color: #e6db74">&quot;license&quot;</span> <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">more</span> <span style="color: #f8f8f2">information</span><span style="color: #f92672">.</span>
<span style="color: #f92672">&gt;&gt;&gt;</span> <span style="color: #f92672">import</span> <span style="color: #f8f8f2">clr</span>
<span style="color: #f92672">&gt;&gt;&gt;</span> <span style="color: #f92672">import</span> <span style="color: #f8f8f2">sys</span>
<span style="color: #f92672">&gt;&gt;&gt;</span> <span style="color: #f8f8f2">sys</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">path</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append(</span><span style="color: #e6db74">r&#39;C:\Program Files\Autodesk\Revit 2018&#39;</span><span style="color: #f8f8f2">)</span>
<span style="color: #f92672">&gt;&gt;&gt;</span> <span style="color: #f8f8f2">clr</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">AddReference(</span><span style="color: #e6db74">&#39;RevitAPI&#39;</span><span style="color: #f8f8f2">)</span>
<span style="color: #f8f8f2">Traceback</span> <span style="color: #f8f8f2">(most</span> <span style="color: #f8f8f2">recent</span> <span style="color: #f8f8f2">call</span> <span style="color: #f8f8f2">last):</span>
  <span style="color: #f8f8f2">File</span> <span style="color: #e6db74">&quot;&lt;stdin&gt;&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">line</span> <span style="color: #ae81ff">1</span><span style="color: #f8f8f2">,</span> <span style="color: #f92672">in</span> <span style="color: #f92672">&lt;</span><span style="color: #f8f8f2">module</span><span style="color: #f92672">&gt;</span>
<span style="color: #a6e22e">IOError</span><span style="color: #f8f8f2">:</span> <span style="color: #f8f8f2">System</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">IO</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">IOException:</span> <span style="color: #f8f8f2">Could</span> <span style="color: #f92672">not</span> <span style="color: #f8f8f2">add</span> <span style="color: #f8f8f2">reference</span> <span style="color: #f8f8f2">to</span> <span style="color: #f8f8f2">assembly</span> <span style="color: #f8f8f2">RevitAPI</span>
   <span style="color: #f8f8f2">at</span> <span style="color: #f8f8f2">IronPython</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Runtime</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">ClrModule</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">AddReference(CodeContext</span> <span style="color: #f8f8f2">context,</span> <span style="color: #f8f8f2">String</span> <span style="color: #f8f8f2">name</span>
<span style="color: #f8f8f2">)</span>
   <span style="color: #f8f8f2">at</span> <span style="color: #f8f8f2">IronPython</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Runtime</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">ClrModule</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">AddReference(CodeContext</span> <span style="color: #f8f8f2">context,</span> <span style="color: #f8f8f2">Object</span> <span style="color: #f8f8f2">refe</span>
<span style="color: #f8f8f2">rence)</span>
   <span style="color: #f8f8f2">at</span> <span style="color: #f8f8f2">IronPython</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Runtime</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">ClrModule</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">AddReference(CodeContext</span> <span style="color: #f8f8f2">context,</span> <span style="color: #f8f8f2">Object[]</span> <span style="color: #f8f8f2">re</span>
<span style="color: #f8f8f2">ferences)</span>
   <span style="color: #f8f8f2">at</span> <span style="color: #f8f8f2">Microsoft</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Scripting</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Interpreter</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">ActionCallInstruction</span><span style="color: #960050; background-color: #1e0010">`</span><span style="color: #ae81ff">2.</span><span style="color: #f8f8f2">Run(InterpretedFra</span>
<span style="color: #f8f8f2">me</span> <span style="color: #f8f8f2">frame)</span>
   <span style="color: #f8f8f2">at</span> <span style="color: #f8f8f2">Microsoft</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Scripting</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Interpreter</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Interpreter</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Run(InterpretedFrame</span> <span style="color: #f8f8f2">frame)</span>
   <span style="color: #f8f8f2">at</span> <span style="color: #f8f8f2">Microsoft</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Scripting</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Interpreter</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">LightLambda</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Run4[T0,T1,T2,T3,TRet](T0</span> <span style="color: #f8f8f2">arg0</span>
<span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">T1</span> <span style="color: #f8f8f2">arg1,</span> <span style="color: #f8f8f2">T2</span> <span style="color: #f8f8f2">arg2,</span> <span style="color: #f8f8f2">T3</span> <span style="color: #f8f8f2">arg3)</span>
   <span style="color: #f8f8f2">at</span> <span style="color: #f8f8f2">System</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Dynamic</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">UpdateDelegates</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">UpdateAndExecute3[T0,T1,T2,TRet](CallSite</span> <span style="color: #f8f8f2">s</span>
<span style="color: #f8f8f2">ite,</span> <span style="color: #f8f8f2">T0</span> <span style="color: #f8f8f2">arg0,</span> <span style="color: #f8f8f2">T1</span> <span style="color: #f8f8f2">arg1,</span> <span style="color: #f8f8f2">T2</span> <span style="color: #f8f8f2">arg2)</span>
   <span style="color: #f8f8f2">at</span> <span style="color: #f8f8f2">Microsoft</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Scripting</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Interpreter</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">FuncCallInstruction</span><span style="color: #960050; background-color: #1e0010">`</span><span style="color: #ae81ff">6.</span><span style="color: #f8f8f2">Run(InterpretedFrame</span>
 <span style="color: #f8f8f2">frame)</span>
   <span style="color: #f8f8f2">at</span> <span style="color: #f8f8f2">Microsoft</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Scripting</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Interpreter</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Interpreter</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Run(InterpretedFrame</span> <span style="color: #f8f8f2">frame)</span>
   <span style="color: #f8f8f2">at</span> <span style="color: #f8f8f2">Microsoft</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Scripting</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Interpreter</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">LightLambda</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Run4[T0,T1,T2,T3,TRet](T0</span> <span style="color: #f8f8f2">arg0</span>
<span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">T1</span> <span style="color: #f8f8f2">arg1,</span> <span style="color: #f8f8f2">T2</span> <span style="color: #f8f8f2">arg2,</span> <span style="color: #f8f8f2">T3</span> <span style="color: #f8f8f2">arg3)</span>
   <span style="color: #f8f8f2">at</span> <span style="color: #f8f8f2">IronPython</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Compiler</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Ast</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">CallExpression</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Invoke1Instruction</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Run(InterpretedF</span>
<span style="color: #f8f8f2">rame</span> <span style="color: #f8f8f2">frame)</span>
   <span style="color: #f8f8f2">at</span> <span style="color: #f8f8f2">Microsoft</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Scripting</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Interpreter</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Interpreter</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Run(InterpretedFrame</span> <span style="color: #f8f8f2">frame)</span>
   <span style="color: #f8f8f2">at</span> <span style="color: #f8f8f2">Microsoft</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Scripting</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Interpreter</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">LightLambda</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Run2[T0,T1,TRet](T0</span> <span style="color: #f8f8f2">arg0,</span> <span style="color: #f8f8f2">T1</span> <span style="color: #f8f8f2">a</span>
<span style="color: #f8f8f2">rg1)</span>
   <span style="color: #f8f8f2">at</span> <span style="color: #f8f8f2">IronPython</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Compiler</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">PythonScriptCode</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">RunWorker(CodeContext</span> <span style="color: #f8f8f2">ctx)</span>
   <span style="color: #f8f8f2">at</span> <span style="color: #f8f8f2">IronPython</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Compiler</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">PythonScriptCode</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Run(Scope</span> <span style="color: #f8f8f2">scope)</span>
   <span style="color: #f8f8f2">at</span> <span style="color: #f8f8f2">IronPython</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Hosting</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">PythonCommandLine</span><span style="color: #f92672">.&lt;&gt;</span><span style="color: #f8f8f2">c__DisplayClass1</span><span style="color: #f92672">.&lt;</span><span style="color: #f8f8f2">RunOneInteraction</span>
<span style="color: #f92672">&gt;</span><span style="color: #f8f8f2">b__0()</span>
<span style="color: #f92672">&gt;&gt;&gt;</span>
</pre></div>


<p>Mà phải dùng <code>ipy64.exe</code> để <code>AddReference</code>:</p>
<div class="codehilite" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #f8f8f2">C:</span>\<span style="color: #f8f8f2">Users</span>\<span style="color: #f8f8f2">HTL</span><span style="color: #f92672">&gt;</span><span style="color: #e6db74">&quot;C:\Program Files (x86)\IronPython 2.7\ipy64.exe&quot;</span>
<span style="color: #f8f8f2">IronPython</span> <span style="color: #ae81ff">2.7</span><span style="color: #f92672">.</span><span style="color: #ae81ff">3</span> <span style="color: #f8f8f2">(</span><span style="color: #ae81ff">2.7</span><span style="color: #f92672">.</span><span style="color: #ae81ff">0.40</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">on</span> <span style="color: #f92672">.</span><span style="color: #f8f8f2">NET</span> <span style="color: #ae81ff">4.0</span><span style="color: #f92672">.</span><span style="color: #ae81ff">30319.42000</span> <span style="color: #f8f8f2">(</span><span style="color: #ae81ff">64</span><span style="color: #f92672">-</span><span style="color: #f8f8f2">bit)</span>
<span style="color: #f8f8f2">Type</span> <span style="color: #e6db74">&quot;help&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;copyright&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;credits&quot;</span> <span style="color: #f92672">or</span> <span style="color: #e6db74">&quot;license&quot;</span> <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">more</span> <span style="color: #f8f8f2">information</span><span style="color: #f92672">.</span>
<span style="color: #f92672">&gt;&gt;&gt;</span> <span style="color: #f92672">import</span> <span style="color: #f8f8f2">clr</span>
<span style="color: #f92672">&gt;&gt;&gt;</span> <span style="color: #f92672">import</span> <span style="color: #f8f8f2">sys</span>
<span style="color: #f92672">&gt;&gt;&gt;</span> <span style="color: #f8f8f2">sys</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">path</span>
<span style="color: #f8f8f2">[</span><span style="color: #e6db74">&#39;.&#39;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&#39;C:</span><span style="color: #ae81ff">\\</span><span style="color: #e6db74">Program Files (x86)</span><span style="color: #ae81ff">\\</span><span style="color: #e6db74">IronPython 2.7</span><span style="color: #ae81ff">\\</span><span style="color: #e6db74">Lib&#39;</span><span style="color: #f8f8f2">,</span>
 <span style="color: #e6db74">&#39;C:</span><span style="color: #ae81ff">\\</span><span style="color: #e6db74">Program Files (x86)</span><span style="color: #ae81ff">\\</span><span style="color: #e6db74">IronPython 2.7</span><span style="color: #ae81ff">\\</span><span style="color: #e6db74">DLLs&#39;</span><span style="color: #f8f8f2">,</span>
 <span style="color: #e6db74">&#39;C:</span><span style="color: #ae81ff">\\</span><span style="color: #e6db74">Program Files (x86)</span><span style="color: #ae81ff">\\</span><span style="color: #e6db74">IronPython 2.7&#39;</span><span style="color: #f8f8f2">,</span>
 <span style="color: #e6db74">&#39;C:</span><span style="color: #ae81ff">\\</span><span style="color: #e6db74">Program Files (x86)</span><span style="color: #ae81ff">\\</span><span style="color: #e6db74">IronPython 2.7</span><span style="color: #ae81ff">\\</span><span style="color: #e6db74">lib</span><span style="color: #ae81ff">\\</span><span style="color: #e6db74">site-packages&#39;</span><span style="color: #f8f8f2">]</span>
<span style="color: #f92672">&gt;&gt;&gt;</span> <span style="color: #f8f8f2">sys</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">path</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append(</span><span style="color: #e6db74">r&#39;C:\Program Files\Autodesk\Revit 2018&#39;</span><span style="color: #f8f8f2">)</span>
<span style="color: #f92672">&gt;&gt;&gt;</span> <span style="color: #f8f8f2">clr</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">AddReference(</span><span style="color: #e6db74">&#39;RevitAPI&#39;</span><span style="color: #f8f8f2">)</span>
<span style="color: #f92672">&gt;&gt;&gt;</span> <span style="color: #f92672">from</span> <span style="color: #f8f8f2">Autodesk.Revit.DB</span> <span style="color: #f92672">import</span> <span style="color: #f8f8f2">Wall</span>
<span style="color: #f92672">&gt;&gt;&gt;</span> <span style="color: #f8f8f2">Wall</span>
<span style="color: #f92672">&lt;</span><span style="color: #f8f8f2">type</span> <span style="color: #e6db74">&#39;Wall&#39;</span><span style="color: #f92672">&gt;</span>
<span style="color: #f92672">&gt;&gt;&gt;</span>
</pre></div>


<h2>AddReference các assemblies được compiled bằng IronPython</h2>
<p>Nếu như bạn chưa biết, IronPython có thể compile python script thành các file assemblies (<code>.dll</code> hoặc <code>.exe</code>) sử dụng công cụ kèm theo là <code>pyc.py</code> (sẽ có bài viết riêng về <strong>Compile python script dùng IronPython</strong>).</p>
<p>Một lưu ý quan trọng khi AddReference các file assemblies này là: <strong>phải dùng đúng phiên bản IronPython tương ứng với phiên bản đã dùng để compile ra file assembly đó thì mới AddReference được</strong>. Ví dụ: file assembly được compiled bằng IronPython 2.7.3 thì khi AddReference ta phải dùng IronPython 2.7.3. Sẽ có ví dụ cụ thể trong bài <strong>Compile python script dùng IronPython</strong>.</p>
  </div>
  <!-- /.entry-content -->
</section>
<section class="container">
  <div class="comments">
    <h3>Comments</h3>
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      var disqus_shortname = 'pymier';
      var disqus_identifier = 'article/ironpython-addreference/';
      var disqus_url = 'http://pp.pymi.vn/article/ironpython-addreference/';
      (function() {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//pymier.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>Please enable JavaScript to view the comments.</noscript>
  </div>
</section>

    <section class="container footer">
      <footer>
        <address>
        Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
        which takes great advantage of <a href="http://python.org">Python</a>.
        </address>
        <address>
          Học lập trình Python tại <a href="https://pymi.vn/">Pymi.vn</a>
        </address>
      </footer>
    </section>
  </main>

<script type="text/javascript">
var images = document.getElementsByTagName("img");
var i;

for(i = 0; i < images.length; i++) {
  images[i].className += " centered";
}
</script>
</body>

</html>